GSET	JSUB	READ		
	COMP	ENTER
	JEQ	PSET
	STCH	TEMP1,X
	LDT	#1
	ADDR	T,X
	J	GSET
PSET	LDT	#2	
	COMPR	X,T
	JEQ	DOUBLE
SINGLE	LDX	#0
	LDCH	TEMP1,X
	LDT	#48
	SUBR	T,A
	STA	SET
	J	RNODE
DOUBLE	LDX	#0
	LDCH	TEMP1,X
	LDT	#48
	SUBR	T,A	
	MUL	#10
	STA	SET
	LDX	#1
	LDCH	TEMP1,X
	LDT	#48
	SUBR	T,A
	LDT	SET
	ADDR	A,T
	STT	SET			
	
RNODE	JSUB	READ		
	COMP	ENTER
	JEQ	RNODE
	LDT	#1
	ADDR	T,S
	STA	TEMP2	
	LDB	TEMP2
	LDT	#65
	SUBR	T,B
	LDT	#3
	MULR	T,B
	STB	TEMP2
	LDX	TEMP2
	STCH	NODE,X
	LDT	#1
	ADDR	T,X
	JSUB	READ
	STCH	NODE,X
	ADDR	T,X
	JSUB	READ
	STCH	NODE,X
	LDB	SET
	COMPR	S,B	
	JLT	RNODE
	
READY	LDB	#66		
	LDT	SET
	LDX	#64
	ADDR	X,T
	STT	LAST
	LDT	#3
	STT	TEMP3		
	LDT	#1
	STT	TEMP4		
	LDX	#0	
	LDCH	NODE,X
	STCH	NDARRY,X
	LDT	#1
	ADDR	T,X
	LDCH	NODE,X
	STCH	NDARRY,X
	ADDR	T,X
	LDCH	NODE,X
	STCH	NDARRY,X
	
LOOP1	LDX	TEMP4	
	LDA	#0	
	LDCH	NDARRY,X
	LDT	COMMA
	COMPR	A,T
	JEQ	LABEL3
	LDT	#0
	COMPR	A,T
	JEQ	LABEL3
	COMPR	A,B
	JEQ	LABEL1
	LDT	#1
	ADDR	T,X
	J	LOOP1
LABEL1	LDT	#2
	MULR	T,X
	LDT	#1
	ADDR	T,X
	STX	TEMP5		
	ADDR	T,X
	STX	TEMP6		
LOOP2	LDX	TEMP3
	LDA	#0
	LDCH	NODE,X
	COMPR	A,B
	JEQ	LABEL2
	LDT	#1
	ADDR	T,X
	J	LOOP2
LABEL2	STX	TEMP7	
	LDT	#1
	ADDR	T,X	
	LDCH	NODE,X
	LDX	TEMP5
	STCH	NDARRY,X
	LDX	TEMP7
	LDT	#2
	ADDR	T,X
	LDCH	NODE,X
	LDX	TEMP6
	STCH	NDARRY,X
	LDT	#1
	ADDR	T,B
	LDT	LAST
	COMPR	B,T
	JEQ	MAIN
	LDX	TEMP3
	LDT	#3
	ADDR	T,X
	STX	TEMP3
	LDX	TEMP4
	LDT	#1
	ADDR	T,X
	STX	TEMP4
	J	LOOP1	
LABEL3	LDX	TEMP4	
	LDT	#1
	ADDR	T,X
	STX	TEMP4
	J	LOOP1
	
MAIN	LDX	#0
	JSUB	STKINIT	
	JSUB	PREORD
MAIN1	LDX	#0
	LDA	#10		
	JSUB	WRITE
	JSUB	STKINIT
	JSUB	INORD
MAIN2	LDX	#0
	LDA	#10
	JSUB	WRITE
	JSUB	STKINIT
	JSUB	PSTORD
EXIT	LDA	#10
	JSUB	WRITE
	
A	J	A	
	
PREORD	LDA	#0	
	LDCH	NDARRY,X
	LDT	COMMA
	COMPR	A,T
	JEQ	STOP1
	LDT	#0
	COMPR	A,T
	JEQ	STOP1
	JSUB	WRITE
	STX	@TOP
	JSUB	PUSH
	LDT	#2
	MULR	T,X
	LDT	#1
	ADDR	T,X
	JSUB	PREORD
	JSUB	POP
	LDX	@TOP
LABEL4	LDT	#2
	MULR	T,X
	ADDR	T,X
	JSUB	PREORD
	JSUB	POP
	LDX	@TOP
	LDT	#STACK
	LDB	#3
	SUBR	B,T
	COMPR	X,T
	JEQ	MAIN1
	J	LABEL4
STOP1	RSUB	

INORD	LDA	#0
	LDCH	NDARRY,X
	LDT	COMMA
	COMPR	A,T
	JEQ	STOP2
	LDT	#0
	COMPR	A,T
	JEQ	STOP2
	STX	@TOP
	JSUB	PUSH
	LDT	#2
	MULR	T,X
	LDT	#1
	ADDR	T,X
	JSUB	INORD
LABEL5	LDT	#2
	MULR	T,X
	ADDR	T,X
	JSUB	INORD
	JSUB	STOP2
	J	LABEL5	
STOP2	JSUB	POP
	LDX	@TOP
	LDT	#STACK
	LDB	#3
	SUBR	B,T
	COMPR	X,T
	JEQ	MAIN2
	LDCH	NDARRY,X
	JSUB	WRITE
	J	LABEL5
	
PSTORD	LDA	#0
	LDCH	NDARRY,X
	LDT	COMMA
	COMPR	A,T
	JEQ	STOP3
	LDT	#0
	COMPR	A,T
	JEQ	STOP3
	STX	@TOP
	JSUB	PUSH
	LDT	#2
	MULR	T,X
	LDT	#1
	ADDR	T,X
	JSUB	PSTORD
	LDT	#1
	ADDR	T,X
	JSUB	PSTORD
	JSUB	POP
	LDX	@TOP
	LDA	#0
	LDCH	NDARRY,X
	LDT	TEMP8
	COMPR	T,A
	JEQ	LABEL7
	STA	TEMP8
	JSUB	WRITE
LABEL6	JSUB	POP
	LDX	@TOP
	STX	@TOP
	JSUB	PUSH
	LDT	#2
	MULR	T,X
	ADDR	T,X
	JSUB	PSTORD
	JSUB	POP
	LDX	@TOP
	LDA	#0
	LDCH	NDARRY,X
	LDT	TEMP8
	COMPR	T,A
	JEQ	LABEL7
	STA	TEMP8
	JSUB	WRITE	
	J	LABEL6
STOP3	RSUB
LABEL7	JSUB	POP
	LDX	@TOP
	LDCH	NDARRY,X
	JSUB	WRITE
	LDT	#STACK
	LDB	#3
	SUBR	B,T
	COMPR	X,T
	JEQ	EXIT
	J	LABEL7
	
STKINIT	LDA	#STACK
	STA	TOP
	RSUB

PUSH	LDA	TOP
	ADD	#3
	STA	TOP
	RSUB
	
POP	LDA	TOP
	SUB	#3
	STA	TOP
	RSUB
	
READ	TD	INPUT
	JEQ	READ
	RD	INPUT
	RSUB
	
WRITE	TD	OUTPUT
	JEQ	WRITE
	WD	OUTPUT
	RSUB
		
INPUT	BYTE	0
OUTPUT	BYTE	1
ENTER	WORD	10
COMMA	WORD	46
SET	RESW	1
TEMP1	RESB	2
TEMP2	RESW	1
TEMP3	RESW	1
TEMP4	RESW	1
TEMP5	RESW	1
TEMP6	RESW	1
TEMP7	RESW	1
TEMP8	RESW	1
LAST	RESW	1
NODE	RESB	78
NDARRY	RESB	1023
TOP	RESW	1
STACK	RESW	10000
